<controls:MetroWindow x:Class="SimpleLauncher.DownloadImagePackWindow"
                      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                      xmlns:controls="http://metro.mahapps.com/winfx/xaml/controls" xmlns:d="http://schemas.microsoft.com/expression/blend/2008" xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" mc:Ignorable="d"
                      Title="{DynamicResource DownloadImagePack}"
                      Width="650"
                      MinWidth="550"
                      Height="600"
                      MinHeight="500"
                      WindowStartupLocation="CenterScreen">
    <Grid>
        <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
            <Grid Margin="10">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>

                <GroupBox Grid.Row="0" Header="{DynamicResource PleaseselectanImagePack}" Margin="10" Padding="0">
                    <ComboBox x:Name="SystemNameDropdown"
                              HorizontalAlignment="Stretch"
                              Margin="10"
                              SelectionChanged="SystemNameDropdown_SelectionChanged" />
                </GroupBox>

                <GroupBox Grid.Row="2" Header="{DynamicResource InstallImagePack}" Margin="10" Padding="0">
                    <ItemsControl x:Name="ImagePacksItemsControl" Margin="10">
                        <ItemsControl.ItemsPanel>
                            <ItemsPanelTemplate>
                                <WrapPanel Orientation="Horizontal" HorizontalAlignment="Center" />
                            </ItemsPanelTemplate>
                        </ItemsControl.ItemsPanel>
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Button Content="{Binding DisplayName}"
                                        HorizontalAlignment="Center"
                                        VerticalAlignment="Center"
                                        Padding="5"
                                        Click="DownloadImagePackButton_Click"
                                        IsEnabled="{Binding IsDownloaded, Converter={StaticResource InverseBooleanConverter}}"
                                        Margin="5" d:DataContext="{d:DesignInstance }" />
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </GroupBox>

                <!-- Adjusted Grid.Row for ProgressBar and subsequent elements -->
                <GroupBox Grid.Row="7" Header="{DynamicResource ProgressBar}" Margin="10" Padding="0">
                    <StackPanel>
                        <Grid Margin="10" HorizontalAlignment="Stretch">
                            <ProgressBar x:Name="DownloadProgressBar"
                                         HorizontalAlignment="Stretch"
                                         Height="29" />
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Text="{DynamicResource DownloadProgress}" />
                        </Grid>

                        <TextBlock x:Name="StatusTextBlock"
                                   Margin="10"
                                   TextWrapping="Wrap" />

                        <Button x:Name="StopDownloadButton"
                                Content="{DynamicResource StopDownload}"
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Padding="5"
                                Margin="10"
                                Click="StopDownloadButton_Click"
                                IsEnabled="False" />
                    </StackPanel>
                </GroupBox>

                <TextBlock Grid.Row="8"
                           Margin="10,10,10,0"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Left"
                           TextWrapping="Wrap"
                           Text="{DynamicResource IncasetheImagePackisnotavailable}" />

                <TextBlock Grid.Row="9"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Left"
                           Margin="10,10,10,0">
                    <Hyperlink NavigateUri="https://github.com/libretro-thumbnails/libretro-thumbnails"
                               RequestNavigate="Hyperlink_RequestNavigate">
                        https://github.com/libretro-thumbnails/libretro-thumbnails
                    </Hyperlink>
                </TextBlock>

                <TextBlock Grid.Row="10"
                           VerticalAlignment="Center"
                           HorizontalAlignment="Left"
                           Margin="10,10,10,20">
                    <Hyperlink NavigateUri="https://emumovies.com/files/" RequestNavigate="Hyperlink_RequestNavigate">https://emumovies.com/files/</Hyperlink>
                </TextBlock>

            </Grid>
        </ScrollViewer>

        <!-- Loading Overlay for extraction -->
        <Grid x:Name="LoadingOverlay" Background="#7F000000" Visibility="Collapsed">
            <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                <controls:ProgressRing IsActive="True" Width="60" Height="60" />
                <TextBlock x:Name="LoadingMessage" Text="Extracting..." Foreground="White" Margin="0,10,0,0" FontSize="16"/>
            </StackPanel>
        </Grid>
    </Grid>
</controls:MetroWindow>
